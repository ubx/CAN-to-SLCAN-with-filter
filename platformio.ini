[platformio]
# Use a local boards directory so we can add custom boards (e.g., ESP32-S3-Zero)
# Populate boards/ with JSON from: https://github.com/sivar2311/platformio_boards
boards_dir = boards

[env:base]
# Common settings shared by all environments to avoid duplication
framework = espidf
platform = espressif32@^6.12.0
monitor_speed = 115200
monitor_filters = esp32_exception_decoder, time
# Prevent RTS/DTR toggling when opening monitor on CDC-ACM port (avoids unintended resets)
monitor_rts = 0
monitor_dtr = 0

# Avoid pulling TinyUSB as a separate lib; we use ESP-IDF's tinyusb component
lib_ignore = tinyusb

custom_app_name = CAN_to_SLCAN
custom_app_version = v1.0.0

extra_scripts =
    add_config.py
    rename_firmware.py

# Static analysis configuration
check_tool = cppcheck
# let PlatformIO skip analyzing external packages that confuse cppcheck
check_skip_packages = yes

# For testing: forward all CAN frames (disable whitelist)
# build_flags = -DIGNORE_WHITELIST

[env:esp32-s3-slcan]
extends = env:base
board = esp32-s3-devkitc-1

# TWAI (CAN) GPIO assignment for esp32-s3-slcan
build_flags =
    -DTWAI_TX_GPIO=18
    -DTWAI_RX_GPIO=17

[env:esp32-s3-zero]
# Board source: https://github.com/sivar2311/platformio_boards.git
# The repo provides custom ESP32-S3 Zero board definitions. Ensure the board
# definition is available to PlatformIO (e.g., by placing the JSON in a boards/
# directory and setting boards_dir, or installing the repo globally).
extends = env:base
board = esp32-s3-fh4r2

# TWAI (CAN) GPIO assignment for esp32-s3-zero
build_flags =
    -DTWAI_TX_GPIO=7
    -DTWAI_RX_GPIO=6



